<!doctype html>
<html lang="en">
  <head>
    <title>Problem Solutions and Random Scripts</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="Content-type"     content="text/html; charset=utf-8" />

    <!-- TODO -->
    <link rel="icon" href="" type="image/x-icon">
    <link rel="shortcut icon" href="" type="image/x-icon">

    <style>
      img {
        max-height: 20px;
      }

      div {
        text-align: center;
        padding: 20px;
      }

      table {
        width: 80%;
        margin: 0 auto;
        border-collapse: collapse;
        text-align: center;
      }

      th {
        font-weight: bold;
        padding: 10px;
      }

      td {
        padding: 10px 20px;
        border-top: 1px solid black;
      }

      tr:hover {
        background-color: #D7E5FF;
      }
    </style>

    <script>
      function filterDownloads() {
        let filter = document.getElementById("filter").value;
        let tableContents = "<tr><th> Filename </th><th> Problem Source </th><th> Problem </th><th> Points </th><th> Source code </th><th> Try me! </th></tr>\n";
        let github = "https://github.com/ConnorMattson/Misc-Scripts-and-Challenge-Solutions/blob/master";
        let pointValues = [3,10,30,100];
        let allowedPoints = [];
        pointValues.forEach((element) => { if (document.getElementById(String(element)).checked) allowedPoints.push(element) });


        data.filter((element) => (element.filename.includes(filter) || element.problem.includes(filter)) && ~allowedPoints.indexOf(element.points)) 
            .forEach(function(element) {
              tableContents += "<tr><td>" + element.filename + "</td>";
              tableContents += "<td><a href='" + element.problemLink + "'>" + element.problemSource + "</a></td>";
              tableContents += "<td>" + element.problem + "</td>";
              tableContents += "<td>" + element.points + "</td>";
              tableContents += "<td><a href='" + github + element.githubLink + "'><img src='https://connormattson.github.io/media/projects/GitHub.svg'></a></td>";
              tableContents += "<td> Coming soon... </td></tr>";
            });
        document.querySelector("table").innerHTML = tableContents;
      }

      function loadData() {
        data = []
        const xhr = new XMLHttpRequest();
        xhr.open("GET", "https://connormattson.github.io/Misc-Scripts-and-Challenge-Solutions/problemData.json", true);

        xhr.onreadystatechange  = (function(response) {
          data = JSON.parse(xhr.responseText);
          filterDownloads("")
        });

        xhr.send(null);
      }

      window.onload = loadData();
    </script>
  </head>

  <body>
    <div>
      Search: <input type="text" id="filter" oninput="filterDownloads()"/><br>
      Point value:  3<input type="checkbox" id="3" onclick="filterDownloads()" checked>
                    10<input type="checkbox" id="10" onclick="filterDownloads()" checked>
                    30<input type="checkbox" id="30" onclick="filterDownloads()" checked>
                    100<input type="checkbox" id="100" onclick="filterDownloads()" checked>
    </div>
    <table>
    </table>
  </body>
</html>